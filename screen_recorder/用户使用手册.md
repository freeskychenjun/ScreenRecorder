# 屏幕录制软件 - 用户使用手册

版本：1.1.0
更新日期：2025年2月

---

## 目录

1. [软件简介](#软件简介)
2. [系统要求](#系统要求)
3. [安装指南](#安装指南)
4. [快速开始](#快速开始)
5. [功能详解](#功能详解)
6. [音频录制指南](#音频录制指南)
7. [高级设置](#高级设置)
8. [常见问题](#常见问题)
9. [快捷键](#快捷键)
10. [技巧与建议](#技巧与建议)

---

## 软件简介

这是一款功能强大的Windows屏幕录制软件，支持：

- **🎥 视频录制**：全屏或自定义区域录制
- **🎤 音频录制**：麦克风、系统音频或同时录制
- **⏸️ 暂停/继续**：录制过程中可暂停
- **🎬 多种编码器**：H264、MJPG、XVID等
- **📊 实时统计**：帧数、时长、FPS显示
- **📁 历史管理**：录制历史记录和管理

---

## 系统要求

### 最低配置

- **操作系统**：Windows 10/11（64位）
- **Python**：3.8 或更高版本
- **内存**：4 GB RAM
- **硬盘**：至少 1 GB 可用空间

### 推荐配置

- **操作系统**：Windows 11（64位）
- **Python**：3.11 或更高版本
- **内存**：8 GB RAM 或更多
- **硬盘**：SSD 固态硬盘
- **显示器**：支持多显示器

---

## 安装指南

### 方法1：使用 Python 源码运行

#### 步骤 1：安装 Python 依赖

打开命令提示符（CMD）或 PowerShell，进入软件目录，运行：

```bash
pip install -r requirements.txt
```

**注意**：如果安装 PyAudio 失败，请使用以下命令安装 Windows 专用版本：

```bash
pip install PyAudioWPatch
```

#### 步骤 2：安装 FFmpeg（音视频合并必需）

**推荐方法**：使用 Chocolatey

```bash
choco install ffmpeg
```

**手动安装**：
1. 访问：https://www.gyan.dev/ffmpeg/builds/
2. 下载 "ffmpeg-release-essentials.zip"
3. 解压到 `C:\ffmpeg`
4. 将 `C:\ffmpeg\bin` 添加到系统 PATH 环境变量

#### 步骤 3：运行程序

```bash
python main.py
```

或双击 `启动.bat` 文件。

### 方法2：使用打包的 EXE 文件（如已构建）

直接双击 `main.exe` 即可运行，无需安装 Python。

---

## 快速开始

### 第一次使用

1. **启动程序**
   ```
   双击 "启动.bat" 或运行 python main.py
   ```

2. **选择录制区域**（可选）
   - 点击左侧 "📷 选择录制区域" 按钮
   - 在屏幕上拖动选择要录制的区域
   - 或直接使用默认的全屏录制

3. **调整设置**（可选）
   - 拖动帧率滑块调整 FPS（10-60）
   - 选择视频编码器（推荐 H264）
   - 设置输出目录

4. **开始录制**
   - 点击 "▶ 开始录制" 按钮
   - 程序会自动隐藏到系统托盘
   - 进行您想要录制的操作

5. **停止录制**
   - 双击系统托盘图标打开窗口
   - 点击 "⏹ 停止" 按钮
   - 视频会自动保存

6. **查看录制**
   - 右侧表格显示录制历史
   - 右键点击文件可打开或删除

---

## 功能详解

### 主界面布局

```
┌─────────────────────────────────────────────────┐
│  屏幕录制软件                    [─][□][×]      │
├─────────────────┬───────────────────────────────┤
│  录制控制       │  录制历史                     │
│  ┌───────────┐ │  ┌─────────────────────────┐  │
│  │ 区域选择  │ │  │ 文件名 | 分辨率|时长... │  │
│  │ 开始按钮  │ │  │                         │  │
│  │ 暂停按钮  │ │  │                         │  │
│  │ 停止按钮  │ │  │                         │  │
│  └───────────┘ │  └─────────────────────────┘  │
│                 │                               │
│  录制设置       │  [刷新] [打开文件夹]          │
│  ┌───────────┐ │                               │
│  │ 帧率设置  │ │                               │
│  │ 编码器    │ │                               │
│  │ 输出目录  │ │                               │
│  └───────────┘ │                               │
│                 │                               │
│  音频设置       │                               │
│  ┌───────────┐ │                               │
│  │ 启用音频  │ │                               │
│  │ 音频源    │ │                               │
│  │ 麦克风    │ │                               │
│  └───────────┘ │                               │
├─────────────────┴───────────────────────────────┤
│  状态栏：就绪                                     │
└─────────────────────────────────────────────────┘
```

### 录制控制

#### 📷 选择录制区域

**全屏录制**（默认）
- 不选择区域，直接开始录制
- 录制整个主显示器

**自定义区域**
1. 点击 "选择录制区域" 按钮
2. 主窗口会隐藏，出现透明遮罩
3. 鼠标拖动选择区域
4. 可从下拉菜单选择预设分辨率（1080p、720p等）
5. 点击 "确定" 完成选择

**多显示器支持**
- 默认录制主显示器
- 可选择任意显示器的特定区域

#### ▶ 开始录制

点击后：
- 程序隐藏到系统托盘
- 开始捕获屏幕
- 如已启用音频，同时开始录制音频
- 实时统计信息开始更新

#### ⏸ 暂停/继续

- **暂停**：停止捕获画面和声音，保持录制状态
- **继续**：恢复捕获，可多次暂停/继续
- 暂停期间不计算时长和帧数

#### ⏹ 停止录制

停止后：
- 如果启用了音频，自动合并音视频
- 保存最终 MP4 文件到输出目录
- 显示完成对话框，包含文件信息
- 添加到录制历史列表

### 录制设置

#### 帧率（FPS）

| 帧率 | 适用场景 | 文件大小 |
|------|----------|----------|
| 10-15 | 文档演示、静态内容 | 最小 |
| 30 | 普通屏幕录制（推荐） | 中等 |
| 60 | 游戏、高动态内容 | 较大 |

**调整方法**：拖动滑块实时调整

#### 视频编码器

| 编码器 | 特点 | 推荐用途 |
|--------|------|----------|
| **H264** | 📦 文件最小，兼容性好 | 长时间录制、存储空间有限 |
| **MJPG** | ⚡ 录制最快，文件较大 | 短视频、后期编辑 |
| **XVID** | ⭐ 平衡选择（推荐） | 日常录制 |
| **MP4V** | 🔧 基础编码器 | 兼容性需求 |

**注意**：H264 可能显示编码器警告，可忽略，视频正常。

#### 输出目录

**默认位置**：`C:\Users\你的用户名\Desktop\Recordings`

**修改方法**：
1. 点击 "输出目录" 旁的 "浏览..." 按钮
2. 选择想要的文件夹
3. 确认

**自动创建**：如果目录不存在，程序会自动创建。

### 音频设置

#### 启用音频录制

勾选 "启用音频录制" 复选框以激活音频功能。

**状态说明**：
- ✅ 可勾选：PyAudioWPatch 已安装，功能可用
- ❌ 灰色禁用：未安装音频库，请运行 `pip install PyAudioWPatch`

#### 音频源选择

| 选项 | 说明 | 适用场景 |
|------|------|----------|
| **仅麦克风** | 只录制麦克风输入 | 教学讲解、配音 |
| **仅系统音频** | 只录制扬声器输出 | 录制音乐、视频声音 |
| **麦克风 + 系统音频** | 同时录制两者（自动混合） | 游戏解说、完整教程 |

**系统音频录制说明**：
- 需要 Windows Loopback 设备支持
- Windows 10/11 通常自动支持
- 如无法录制系统音频，可能需要启用"立体声混音"设备

#### 麦克风设备选择

如果系统有多个麦克风设备：
- 从下拉列表选择要使用的设备
- "默认设备" 使用系统默认麦克风
- Loopback 设备用于录制系统音频

**设备列表说明**：
- 带 `[Loopback]` 标记的是系统音频设备
- 其他设备通常是麦克风输入

### 录制状态

实时显示当前录制信息：

| 项目 | 说明 |
|------|------|
| **状态** | 空闲 / 录制中 / 已暂停 / 停止中 |
| **已录帧数** | 当前已捕获的视频帧数 |
| **时长** | 录制时长（格式：分:秒） |
| **实际FPS** | 实际达到的帧率 |

---

## 音频录制指南

### 录制麦克风声音

**适用场景**：教学讲解、视频配音、语音备注

**设置步骤**：
1. 勾选 "启用音频录制"
2. 选择音频源：**仅麦克风**
3. 选择要使用的麦克风设备
4. 开始录制

**注意事项**：
- 确保麦克风在系统设置中已启用
- 录制前测试麦克风音量
- 避免环境噪音干扰

### 录制系统音频（扬声器声音）

**适用场景**：录制音乐、视频会议、软件演示音效

**设置步骤**：
1. 勾选 "启用音频录制"
2. 选择音频源：**仅系统音频**
3. 开始录制

**Windows 系统音频设置**：

如果无法录制系统音频，请检查：

1. **启用立体声混音**（Windows 10）：
   - 右键任务栏音量图标 → "声音设置"
   - 滚动到 "更多声音设置" 或 "声音控制面板"
   - 切换到 "录制" 选项卡
   - 右键空白处 → 勾选 "显示禁用的设备"
   - 找到 "立体声混音" → 右键 → "启用"
   - 设为默认设备（可选）

2. **Windows 11**：
   - 设置 → 系统 → 声音
   - "更多声音设置"
   - 同上述步骤

**注意**：大多数现代 Windows 10/11 系统会自动检测 Loopback 设备，无需额外配置。

### 同时录制麦克风和系统音频

**适用场景**：游戏解说、完整教程、视频会议录制

**设置步骤**：
1. 勾选 "启用音频录制"
2. 选择音频源：**麦克风 + 系统音频**
3. 选择麦克风设备
4. 调整麦克风和系统音量平衡
5. 开始录制

**音频混合**：
- 程序自动混合两个音频源
- 混合比例无法调整，建议在系统设置中调整音量
- 混合后的音频保存在单个音轨中

### 音频质量问题

**音量太小**：
- 提高系统音量
- 提高麦克风增益（在声音设置中）
- 距离麦克风更近

**有噪音**：
- 使用降噪麦克风
- 录制时减少背景噪音
- 在后期编辑中降噪

**音频延迟**：
- 正常情况下延迟 < 100ms
- 如发现明显延迟，降低 FPS 或关闭其他程序

---

## 高级设置

### 配置文件位置

设置保存在：
```
C:\Users\你的用户名\.screen_recorder\settings.json
```

**可修改的设置**：
```json
{
  "fps": 30,                    // 帧率
  "codec": "H264",              // 编码器
  "output_dir": "路径",         // 输出目录
  "enable_audio": true,         // 启用音频
  "audio_source": "both",       // 音频源
  "audio_device": null,         // 音频设备
  "last_region": null,          // 上次使用的区域
  "show_click_effects": true    // 显示点击效果
}
```

### 调整录制质量

**降低文件大小**：
- 降低 FPS（30 → 15）
- 使用 H264 编码器
- 缩短录制时长

**提高质量**：
- 提高 FPS（30 → 60）
- 使用 MJPG 编码器（文件较大）
- 录制更高分辨率

### 性能优化

**提高录制流畅度**：
1. 降低 FPS
2. 使用更简单的编码器（MJPG）
3. 关闭不必要的后台程序
4. 将输出目录设在 SSD 上

**降低 CPU 占用**：
- 降低 FPS
- 使用硬件编码器（如可用）
- 减小录制区域

---

## 常见问题

### 安装问题

**Q: 提示 "No module named 'xxx'"**
```
A: 打开命令提示符，运行：
   pip install -r requirements.txt
```

**Q: PyAudio 安装失败**
```
A: 使用 Windows 专用版本：
   pip install PyAudioWPatch
```

**Q: FFmpeg 未找到**
```
A: 安装 FFmpeg：
   choco install ffmpeg
   或手动下载并添加到 PATH
```

### 录制问题

**Q: 录制的视频是黑屏**
```
A: 检查：
   1. 是否选择了正确的录制区域
   2. 尝试使用全屏录制
   3. 关闭硬件加速（浏览器、播放器）
```

**Q: 录制卡顿、丢帧**
```
A: 解决方法：
   1. 降低 FPS（60 → 30）
   2. 使用 MJPG 编码器
   3. 关闭其他占用 CPU 的程序
   4. 将输出目录设在 SSD
```

**Q: 录制的视频很大**
```
A: 减小文件大小：
   1. 降低 FPS
   2. 使用 H264 编码器
   3. 缩短录制时长
   4. 缩小录制区域
```

### 音频问题

**Q: 没有录到声音**
```
A: 检查：
   1. 是否勾选 "启用音频录制"
   2. 音频设备是否被其他程序占用
   3. 系统音量和麦克风是否启用
   4. FFmpeg 是否正确安装（音视频合并需要）
```

**Q: 无法录制系统音频**
```
A: 解决方法：
   1. 启用 "立体声混音" 设备
   2. 检查 Loopback 设备是否可用
   3. 尝试不同的音频源选项
```

**Q: 音视频不同步**
```
A: 可能原因和解决：
   1. CPU 性能不足 → 降低 FPS
   2. 磁盘 I/O 瓶颈 → 使用 SSD
   3. 录制时长过长 → 分段录制
```

**Q: 音质差或有噪音**
```
A: 改善音质：
   1. 使用更好的麦克风
   2. 减少环境噪音
   3. 调整麦克风增益
   4. 在后期编辑中降噪
```

### 文件问题

**Q: 找不到录制的视频**
```
A: 检查：
   1. 输出目录设置（主界面显示）
   2. 点击 "打开文件夹" 按钮
   3. 默认位置：桌面\Recordings
```

**Q: 视频无法播放**
```
A: 解决方法：
   1. 使用 VLC 播放器尝试
   2. 检查文件是否损坏
   3. 重新安装视频解码器（K-Lite Codec Pack）
```

**Q: 想删除录制历史**
```
A: 两种方法：
   1. 菜单 → 设置 → 清空历史记录（只清空列表）
   2. 右键文件 → 删除（删除实际文件）
```

---

## 快捷键

### 主界面快捷键

| 快捷键 | 功能 |
|--------|------|
| `Ctrl + O` | 打开输出文件夹 |
| `Ctrl + Q` | 退出程序 |

### 系统托盘

- **双击托盘图标**：显示/隐藏主窗口
- **右键托盘图标**：显示快捷菜单

### 录制过程中

- 程序会自动隐藏，可通过托盘图标控制
- 托盘菜单提供开始/停止/暂停功能

---

## 技巧与建议

### 录制技巧

**1. 教学视频**
- 使用全屏录制
- FPS 设为 30
- 启用麦克风录制
- 使用 H264 编码器减小文件

**2. 游戏录制**
- FPS 设为 60
- 仅录制游戏窗口（使用区域选择）
- 启用混合音频录制
- 使用 MJPG 或 H264

**3. 软件演示**
- 缩小录制区域到软件窗口
- FPS 设为 15-20
- 使用鼠标高亮功能（如可用）
- 添加语音讲解

**4. 视频会议录制**
- 使用全屏录制
- 启用混合音频（麦克风+系统）
- FPS 设为 30
- 注意会议隐私设置

### 性能优化建议

**最佳配置**（平衡性能和质量）：
- FPS：30
- 编码器：H264
- 音频：如需要则启用
- 输出：SSD

**高性能配置**（游戏、高动态内容）：
- FPS：60
- 编码器：MJPG
- 音频：启用
- 输出：SSD

**最小配置**（文档、静态内容）：
- FPS：15
- 编码器：H264
- 音频：按需
- 输出：任意

### 存储管理

**估算文件大小**：
- 1080p @ 30FPS @ H264：约 100-200 MB/分钟
- 1080p @ 60FPS @ MJPG：约 500-800 MB/分钟
- 720p @ 30FPS @ H264：约 50-100 MB/分钟

**节省空间建议**：
- 定期清理旧录制
- 使用 H264 编码器
- 降低不必要的 FPS
- 压缩或归档旧视频

### 后期处理建议

**推荐软件**：
- **剪辑**：DaVinci Resolve（免费）、Shotcut
- **压缩**：HandBrake
- **转码**：FFmpeg 命令行
- **简单编辑**：Windows Photos 应用

**常用 FFmpeg 命令**：
```bash
# 压缩视频
ffmpeg -i input.mp4 -crf 28 output.mp4

# 提取音频
ffmpeg -i input.mp4 -vn -acodec copy audio.aac

# 调整分辨率
ffmpeg -i input.mp4 -vf scale=1280:720 output.mp4
```

---

## 技术支持

### 获取帮助

1. **查看文档**：
   - 本使用手册
   - `AUDIO_FEATURE_README.md`（音频功能详解）
   - `CLAUDE.md`（开发者文档）

2. **检查设置**：
   - 配置文件位置：`.screen_recorder/settings.json`
   - 查看控制台输出的错误信息

3. **常见问题**：
   - 查看本文档 "常见问题" 章节

### 反馈与贡献

如果您发现 Bug 或有功能建议：
- 记录重现步骤
- 截图或录屏
- 提供系统信息（Windows 版本、Python 版本等）

---

## 附录

### 文件格式说明

**输出格式**：MP4（H.264/MJPEG 视频 + AAC 音频）

**临时文件**：
- 录制过程中可能生成临时文件
- 停止录制后自动清理
- 如异常退出，可能需要手动删除 `*_temp*` 文件

### 版本历史

**v1.1.0**（2025年2月）
- ✨ 新增音频录制功能
- ✨ 支持麦克风、系统音频、混合录制
- 🐛 修复多个稳定性问题
- 📝 完善文档

**v1.0.0**（初始版本）
- 基础屏幕录制功能
- 区域选择
- 多编码器支持
- 录制历史管理

---

**感谢使用本软件！**

如有任何问题或建议，欢迎反馈。
